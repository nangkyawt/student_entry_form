<div *ngIf="showSuccessMessage" class="alert alert-success" role="alert">
  Student add successfully!
</div>

<nav class="navbar navbar-expand-lg">
  <div class="container-fluid">
    <a class="navbar-brand" href="#">STUDENTS FORM</a>
    <nav class="navbar bg-body-tertiary">
      <form class="d-flex" role="search">
        <i class="fa-solid fa-magnifying-glass" aria-hidden="true"></i>
        <input
          class="form-control me-2"
          type="search"
          name="search"
          [(ngModel)]="searchText"
          placeholder="Search"
          aria-label="Search"
        />
        <button class="btn btn-outline-success" type="submit">Search</button>
      </form>
    </nav>

    <div class="collapse navbar-collapse" id="navbarNavDropdown">
      <ul class="navbar-nav ms-auto">
        <!-- <li class="nav-item">
          <a class="nav-link" routerLink="/Search">Search</a>
        </li> -->

        <li class="nav-item">
          <button
            type="button"
            class="btn btn-primary"
            data-bs-toggle="modal"
            data-bs-target="#exampleModal"
          >
            Add Student
          </button>
        </li>
        <button
          type="button"
          class="btn btn-secondary"
          data-bs="modal"
          (click)="exportToExcel(results, 'studentForm')"
        >
          Excel
        </button>
      </ul>
    </div>
  </div>
</nav>

<!-- Modal -->
<div
  class="modal fade"
  id="exampleModal"
  tabindex="-1"
  aria-labelledby="exampleModalLabel"
  aria-hidden="true"
>
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-5" id="exampleModalLabel">
          Add Student Data
        </h1>
        <button
          type="button"
          class="btn-close"
          data-bs-dismiss="modal"
          aria-label="Close"
        ></button>
      </div>
      <div class="modal-body">
        <div class="container-fluid">
          <form #studentForm="ngForm" (ngSubmit)="(studentForm.form.valid)">
            <tr class="mb-3">
              <td><label for="identify" class="form-label">ID</label></td>
              <td>
                <input
                  type="number"
                  placeholder="Enter your Id"
                  class="form-control"
                  id="id"
                  name="id"
                  #identify="ngModel"
                  [(ngModel)]="students.id"
                  required
                  aria-describedby="emailHelp"
                /><span class="span" *ngIf="identify.touched && identify.errors"
                  >Please enter id</span
                >
              </td>
            </tr>
            <tr class="mb-3">
              <td>
                <label for="exampleInputEmail1" class="form-label">Name</label>
              </td>
              <td>
                <input
                  type="text"
                  placeholder="Enter your name"
                  class="form-control"
                  id="exampleInputEmail1"
                  #exampleInputEmail1="ngModel"
                  name="name"
                  [(ngModel)]="students.name"
                  required
                  aria-describedby="emailHelp"
                />
                <span
                  class="span"
                  *ngIf="
                    exampleInputEmail1.touched && exampleInputEmail1.errors
                  "
                  >Please enter your name</span
                >
              </td>
            </tr>
            <tr class="mb-3">
              <td>
                <label for="exampleInputPassword1" class="form-label"
                  >Father Name</label
                >
              </td>
              <td>
                <input
                  type="text"
                  placeholder="Enter name"
                  class="form-control"
                  id="exampleInputPassword1"
                  #exampleInputPassword1="ngModel"
                  name="father_name"
                  [(ngModel)]="students.father_name"
                  required
                />
                <span
                  class="span"
                  *ngIf="
                    exampleInputPassword1.touched &&
                    exampleInputPassword1.errors
                  "
                  >Please enter name</span
                >
              </td>
            </tr>
            <tr class="mb-3">
              <td><label for="datepicker">Date of Birth:</label></td>
              <td>
                <input
                  class="form-control"
                  type="date"
                  id="datepicker"
                  name="datepicker"
                  [(ngModel)]="students.date_of_birth"
                  required
                />
              </td>
              <!-- <p>Selected Date: {{ selectedDate }}</p> -->
              <div *ngIf="valiAge()" class="text-danger">
                Student must be 18years and above.
              </div>
            </tr>
            <div class="mb-3">
              <div class="form-check form-check-inline">
                <input
                  class="form-check-input"
                  type="radio"
                  name="inlineRadioOptions"
                  id="inlineRadio1"
                  value="option1"
                  (change)="gendermale()"
                  [(ngModel)]="students.gender"
                />
                <label class="form-check-label" for="inlineRadio1">Male</label>
              </div>
              <div class="form-check form-check-inline">
                <input
                  class="form-check-input"
                  type="radio"
                  name="inlineRadioOptions"
                  id="inlineRadio2"
                  value="option2"
                  (change)="genderfemale()"
                  [(ngModel)]="students.gender"
                />
                <label class="form-check-label" for="inlineRadio2"
                  >Female</label
                >
              </div>
            </div>
            <div class="mb-3 form-check">
              <label class="form-check-label" for="exampleCheck1"
                >NRC Exists:</label
              >
              <input
                type="checkbox"
                class="form-check-input"
                name="nrc_exists"
                id="exampleCheck1"
                [(ngModel)]="students.nrc_exists"
              />
            </div>

            <tr class="mb-3">
              <td>
                <label for="exampleInputEmail1" class="form-label">NRC</label>
              </td>
              <td>
                <input
                  type="text"
                  placeholder="Enter your NRC"
                  class="form-control"
                  name="nrc"
                  id="exampleInputEmail1"
                  [(ngModel)]="students.nrc"
                  [disabled]="!students.nrc_exists"
                />
              </td>
            </tr>
          </form>
        </div>
      </div>
      <div class="modal-footer">
        <button
          type="button"
          class="btn btn-secondary"
          data-bs="modal"
          (click)="new_data(studentForm)"
        >
          New
        </button>

        <button
          type="button"
          class="btn btn-primary"
          data-bs-dismiss="modal"
          (click)="savestudent()"
        >
          Submit
        </button>
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
          Close
        </button>
      </div>
    </div>
  </div>
</div>
<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th class="table1">Id</th>
      <th class="table1">Name</th>
      <th class="table1">Father Name</th>
      <th class="table1">Date of Birth</th>
      <th class="table1">Gender</th>
      <th class="table1">Nrc Exists</th>
      <th class="table1">Nrc</th>
      <th class="table1">Action</th>
    </tr>
  </thead>
  <tbody>
    <tr
      *ngFor="
        let result of results
          | search : searchText
          | paginate : { itemsPerPage: pageSize, currentPage: currentPage }
      "
    >
      <td>{{ result.id }}</td>
      <td>{{ result.name }}</td>
      <td>{{ result.father_name }}</td>
      <td>{{ result.date_of_birth | date : "yyyy-MM-dd" : "UTC" }}</td>
      <td>{{ result.gender | gender }}</td>
      <td>{{ result.nrc_exists }}</td>
      <td>{{ result.nrc }}</td>
      <button
        type="button"
        data-bs-toggle="modal"
        data-bs-target="#exampleModal1"
        class="btn btn success me-2"
        (click)="getarray(result)"
      >
        Edit
      </button>

      <button
        type="button"
        value="Delete"
        class="btn btn danger"
        data-bs-target="#delete"
        aria-hidden="true"
        data-bs-toggle="modal"
        (click)="getId(result.id)"
      >
        Delete
      </button>
    </tr>
  </tbody>
</table>
<pagination-controls
  class="d-flex justify-content-center"
  (pageChange)="currentPage = $event"
></pagination-controls>
<div
  class="modal fade"
  id="exampleModal1"
  tabindex="-1"
  aria-labelledby="exampleModalLabel"
  aria-hidden="true"
>
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-5" id="exampleModalLabel">
          Edit Student Data
        </h1>
        <button
          type="button"
          class="btn-close"
          data-bs-dismiss="modal"
          aria-label="Close"
        ></button>
      </div>
      <div class="modal-body">
        <div class="container-fluid">
          <form>
            <tr class="mb-3">
              <td><label for="identify" class="form-label">ID</label></td>
              <td>
                <input
                  type="number"
                  placeholder="Enter your Id"
                  class="form-control"
                  id="id"
                  name="id"
                  #identify="ngModel"
                  [(ngModel)]="array.id"
                  disabled
                  aria-describedby="emailHelp"
                />
              </td>
            </tr>
            <tr class="mb-3">
              <td>
                <label for="exampleInputEmail1" class="form-label">Name</label>
              </td>
              <td>
                <input
                  type="text"
                  placeholder="Enter your name"
                  class="form-control"
                  id="exampleInputEmail1"
                  name="name"
                  [(ngModel)]="array.name"
                  aria-describedby="emailHelp"
                />
              </td>
            </tr>
            <tr class="mb-3">
              <td>
                <label for="exampleInputPassword1" class="form-label"
                  >Father Name</label
                >
              </td>
              <td>
                <input
                  type="text"
                  placeholder="Enter name"
                  class="form-control"
                  id="exampleInputPassword1"
                  name="father_name"
                  [(ngModel)]="array.father_name"
                  required
                />
              </td>
            </tr>
            <tr class="mb-3">
              <td><label for="datepicker">Date of Birth:</label></td>
              <td>
                <input
                  class="form-control"
                  type="date"
                  id="datepicker"
                  name="datepicker"
                  [(ngModel)]="array.date_of_birth"
                />
              </td>
            </tr>
            <div class="mb-3">
              <div class="form-check form-check-inline">
                <input
                  class="form-check-input"
                  type="radio"
                  name="inlineRadioOptions"
                  id="inlineRadio1"
                  value="option1"
                />
                <label class="form-check-label" for="inlineRadio1">Male</label>
              </div>
              <div class="form-check form-check-inline">
                <input
                  class="form-check-input"
                  type="radio"
                  name="inlineRadioOptions"
                  id="inlineRadio2"
                  value="option2"
                />
                <label class="form-check-label" for="inlineRadio2"
                  >Female</label
                >
              </div>
            </div>
            <div class="mb-3 form-check">
              <label class="form-check-label" for="exampleCheck1"
                >NRC Exists:</label
              >
              <input
                type="checkbox"
                class="form-check-input"
                name="nrc_exists"
                id="exampleCheck1"
                [(ngModel)]="array.nrc_exists"
              />
            </div>

            <tr class="mb-3">
              <td>
                <label for="exampleInputEmail1" class="form-label">NRC</label>
              </td>
              <td>
                <input
                  type="text"
                  placeholder="Enter your NRC"
                  class="form-control"
                  name="nrc"
                  id="exampleInputEmail1"
                  [(ngModel)]="array.nrc"
                  [disabled]="!array.nrc_exists"
                />
              </td>
            </tr>
          </form>
        </div>
      </div>
      <div class="modal-footer">
        <button
          type="button"
          class="btn btn-primary"
          data-bs-dismiss="modal"
          (click)="updatestudent()"
        >
          Submit
        </button>
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
          Close
        </button>
      </div>
    </div>
  </div>
</div>
<div class="modal" tabindex="-1" id="delete">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Delete</h5>
        <button
          type="button"
          class="btn-close"
          data-bs-dismiss="modal"
          ata-bs-target="#exampleModal1"
          aria-label="Close"
        ></button>
      </div>
      <div class="modal-body">
        <p>Are you sure want to delete?</p>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
          Close
        </button>
        <button
          type="button"
          value="delete"
          class="btn btn danger"
          data-bs-dismiss="modal"
          (click)="deletestudent()"
        >
          Delete
        </button>
      </div>
    </div>
  </div>
</div>
<input type="file" (change)="importFromExcel($event)" />
